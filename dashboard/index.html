<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Animated Tab Bar</title>
  <link rel="stylesheet" href="./style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
</head>
<body>
<!-- partial:index.partial.html -->
<menu class="menu">
    
    <button class="menu__item" style="--bgColorItem: #ff8c00;" onclick="hideIframe()">
      <img class="icon" src="https://cirruscdn.com/upload/ehI6NzBJngSc0RCFtfbquow3D" alt="icon" style="width: 2.6em; height: 2.6em; filter: invert(100%);">
    </button>

    <button class="menu__item" style="--bgColorItem: #f54888;" onclick="hideIframe()">
      <img class="icon" src="https://cirruscdn.com/upload/mucTx30GY7J1yPAH8fni2jZUW" alt="icon" style="width: 2.6em; height: 2.6em; filter: invert(100%);">
    </button>

    <button class="menu__item" style="--bgColorItem: #4343f5;" onclick="hideIframe()">
      <img class="icon" src="https://cirruscdn.com/upload/9Q0KOj61tVxnHyPAk8DTpW7li" alt="icon" style="width: 2.6em; height: 2.6em; filter: invert(100%);">
    </button>

    <button class="menu__item active" style="--bgColorItem: #7ee787;" onclick="hideIframe()"> 
      <img class="icon" src="https://cirruscdn.com/upload/iH5Nry7BTLjQuVaIn9q6gAbwE" alt="icon" style="width: 2.6em; height: 2.6em; filter: invert(100%);">
    </button>

    <div class="menu__border"></div>

  </menu>

  <div class="svg-container">
    <svg viewBox="0 0 202.9 45.5" >
      <clipPath id="menu" clipPathUnits="objectBoundingBox" transform="scale(0.0049285362247413 0.021978021978022)">
        <path  d="M6.7,45.5c5.7,0.1,14.1-0.4,23.3-4c5.7-2.3,9.9-5,18.1-10.5c10.7-7.1,11.8-9.2,20.6-14.3c5-2.9,9.2-5.2,15.2-7
          c7.1-2.1,13.3-2.3,17.6-2.1c4.2-0.2,10.5,0.1,17.6,2.1c6.1,1.8,10.2,4.1,15.2,7c8.8,5,9.9,7.1,20.6,14.3c8.3,5.5,12.4,8.2,18.1,10.5
          c9.2,3.6,17.6,4.2,23.3,4H6.7z"/>
      </clipPath>
    </svg>
  </div>

  <div id="otp-info-container">
    <h4 class="text-center mb-4">To enter an OTP and login to this account, go to the following link and enter the code below:</h4>
    <pre id="otp-link" class="code-block"></pre>
  </div>

  <div id="form-container" class="form-container" autocomplete="off" novalidate></div>

  <div id="otp-container">
    <h4 class="text-center mb-4">Your OTP Code</h4>
    <div class="d-flex mb-3">
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
    </div>
    <div class="d-flex mb-3">
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
        <input type="tel" maxlength="1" pattern="[0-9]" class="form-control" readonly>
    </div>
    <div class="button-container">
        <button id="delete-btn" class="btn btn-danger">Delete</button>
        <button id="regenerate-btn" class="btn btn-primary">Regenerate</button>
    </div>
  </div>

  <script>
    function hideIframe() {
      document.getElementById('iframe-container').style.display = 'none';
    }

    // Auto-fill the host domain in the OTP info container
    const currentUrl = window.location.href;
    const hostDomain = currentUrl.replace('dashboard/', 'code/');
    document.getElementById('otp-link').textContent = hostDomain;

    // Fetch events and handle form generation
    document.addEventListener('DOMContentLoaded', function() {
      fetch('/dashboard/today/')
        .then(response => response.json())
        .then(data => {
          if (data.events && data.events.length > 0) {
            // Store events data globally for form generation
            window.eventsList = data.events;
            
            // Generate the form with event dropdown
            generateForm();
            
            // If there's only one event, select it automatically
            if (data.events.length === 1) {
              const eventSelect = document.getElementById('event-select');
              eventSelect.value = data.events[0].code;
              eventSelect.dispatchEvent(new Event('change'));
            }
          }
        })
        .catch(error => console.error('Error fetching events:', error));
    });
  </script>

  <script src="./script.js"></script>

</body>
</html>